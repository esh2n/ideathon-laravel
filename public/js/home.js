function scrollPaubos(){var e=document.getElementById("messageThread");e.scrollTop=e.scrollHeight}function openChatBox(e,s,a){function t(){i=0,$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"GET",url:"/loadMessage/"+e.id+"/"+s,success:function(e){for($("#messageThread").html("");null!=e[0][i];)e[1][0]==e[0][i].message_users_id?$("#messageThread").append('<div class="p-2 d-flex"><div class="px-2 pt-2 pb-0 receiverBox ml-auto"><p>'+e[0][i].message+"</p></div></div>"):$("#messageThread").append('<div class="p-2 d-flex"><div class="px-2 pt-2 pb-0 float-left senderBox"><p>'+e[0][i].message+"</p></div></div>"),lastMessageId=e[0][i].id+1,i++;scrollPaubos(),o()}})}function o(){i=0,$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"GET",url:"/retrieveMessages/"+e.id+"/"+s+"/"+lastMessageId,success:function(e){for(;null!=e[i];)$("#messageThread").append('<div class="p-2 d-flex"><div class="p-2 float-left senderBox"><p>'+e[i].message+"</p></div></div>"),lastMessageId=e[i].id+1,i++;scrollPaubos()},complete:function(){o()}})}$("#messageThread").html('<h1 class="text-center"> Loading. . .'),$("#default_card").hide(),$("#active_card").show();var n=document.getElementById("chatWithName"),d=document.getElementById("convo_id");n.innerHTML=a.nickname,console.log(e),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"GET",url:"/checkConvo/"+e.id,success:function(e){d.value=e,t()},error:function(e){console.log(error)}})}function submitMessage(){event.preventDefault(),$("#messageThread").append('<div class="p-2 d-flex"><div class="p-2 receiverBox ml-auto"><p>'+$("#messsageInput").val()+"</p></div></div>"),$.ajax({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"POST",url:"/sendMessage",data:{convo_id:$("#convo_id").val(),message:$("#messsageInput").val()},success:function(e){},error:function(e){console.log(error)}}),$("#messsageInput").val(""),scrollPaubos()}var lastMessageId=0;
